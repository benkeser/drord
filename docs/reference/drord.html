<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Doubly robust estimates of for evaluating effects 
of treatments on ordinal outcomes. — drord • drord</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Doubly robust estimates of for evaluating effects 
of treatments on ordinal outcomes. — drord" />
<meta property="og:description" content="The available parameters for evaluating treatment efficacy are:
Difference in (weighted) means: The outcome levels are treated
numerically, with each level possibly assigned a weight. The difference
in average outcomes is computed.
Log odds ratio: The comparison describes the average log-odds (treatment
level 1 versus 0) of the cumulative probability for each level of the outcome.
Mann-Whitney: The probability that a randomly-selected individual 
receiving treatment 1 will have a larger outcome value than a randomly selected
individual receiving treatment 0 (with ties assigned weight 1/2).

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drord</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/using_drord.html">`drord`: Doubly robust estimators of ordinal treatment effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/benkeser/drord/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Doubly robust estimates of for evaluating effects 
of treatments on ordinal outcomes.</h1>
    <small class="dont-index">Source: <a href='https://github.com/benkeser/drord/blob/master/R/cdf_estimation.R'><code>R/cdf_estimation.R</code></a></small>
    <div class="hidden name"><code>drord.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The available parameters for evaluating treatment efficacy are:</p><ul>
<li><p>Difference in (weighted) means: The outcome levels are treated
numerically, with each level possibly assigned a weight. The difference
in average outcomes is computed.</p></li>
<li><p>Log odds ratio: The comparison describes the average log-odds (treatment
level 1 versus 0) of the cumulative probability for each level of the outcome.</p></li>
<li><p>Mann-Whitney: The probability that a randomly-selected individual 
receiving treatment 1 will have a larger outcome value than a randomly selected
individual receiving treatment 0 (with ties assigned weight 1/2).</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>drord</span><span class='op'>(</span>
  <span class='va'>out</span>,
  <span class='va'>treat</span>,
  <span class='va'>covar</span>,
  out_levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span><span class='op'>)</span>,
  out_form <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>covar</span><span class='op'>)</span>, collapse <span class='op'>=</span> <span class='st'>"+"</span><span class='op'>)</span>,
  out_weights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>out_levels</span><span class='op'>)</span><span class='op'>)</span>,
  out_model <span class='op'>=</span> <span class='st'>"pooled-logistic"</span>,
  treat_form <span class='op'>=</span> <span class='st'>"1"</span>,
  param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"weighted_mean"</span>, <span class='st'>"log_odds"</span>, <span class='st'>"mann_whitney"</span><span class='op'>)</span>,
  ci <span class='op'>=</span> <span class='st'>"wald"</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  nboot <span class='op'>=</span> <span class='fl'>10000</span>,
  return_models <span class='op'>=</span> <span class='cn'>TRUE</span>,
  est_dist <span class='op'>=</span> <span class='cn'>TRUE</span>,
  stratify <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>out</th>
      <td><p>A <code>numeric</code> vector containing the outcomes. Missing outcomes are 
allowed.</p></td>
    </tr>
    <tr>
      <th>treat</th>
      <td><p>A <code>numeric</code> vector containing treatment status. Missing
values are not allowed unless the corresponding entry in <code>out</code> is also missing. 
Only values of 0 or 1 are treated as actual treatment levels. Any other value is assumed 
to encode a value for which the outcome is missing and the corresponding outcome value is 
ignored.</p></td>
    </tr>
    <tr>
      <th>covar</th>
      <td><p>A <code>data.frame</code> containing the covariates to include in the working
proportional odds model.</p></td>
    </tr>
    <tr>
      <th>out_levels</th>
      <td><p>A <code>numeric</code> vector containing all ordered levels of the 
outcome.</p></td>
    </tr>
    <tr>
      <th>out_form</th>
      <td><p>The right-hand side of a regression formula for the working proportional 
odds model. NOTE: THIS FORMULA MUST NOT SUPPRESS THE INTERCEPT.</p></td>
    </tr>
    <tr>
      <th>out_weights</th>
      <td><p>A vector of <code>numeric</code> weights with length equal to the length 
of <code>out_levels</code>.</p></td>
    </tr>
    <tr>
      <th>out_model</th>
      <td><p>Which R function should be used to fit the proportional odds 
model. The recommended option is <code>"pooled-logistic"</code>. Other options available include
<code>"polr"</code> (from the <code>MASS</code> package), 
"vglm" (from the <code>VGAM</code> package), or <code>"clm"</code> (from the <code>ordinal</code> package).</p></td>
    </tr>
    <tr>
      <th>treat_form</th>
      <td><p>The right-hand side of a regression formula for the working model of
treatment probability as a function of covariates</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A vector of <code>characters</code> indicating which of the three treatment
effect parameters should be estimated (<code>"weighted_mean", "log_odds",</code> 
and/or <code>"mann_whitney"</code>).</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>A vector of <code>characters</code> indicating which confidence intervals
should be computed (<code>"bca"</code> and/or <code>"wald"</code>)</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Confidence intervals have nominal level 1-<code>alpha</code>.</p></td>
    </tr>
    <tr>
      <th>nboot</th>
      <td><p>Number of bootstrap replicates used to compute bootstrap confidence
intervals.</p></td>
    </tr>
    <tr>
      <th>return_models</th>
      <td><p>If <code>TRUE</code> the fitted working proportional odds models
and treatment probability models are returned.</p></td>
    </tr>
    <tr>
      <th>est_dist</th>
      <td><p>A <code>boolean</code> indicating whether estimates of the CDF and PMF 
should be computed and returned. For real data analysis, we generally recommend 
leaving as <code>TRUE</code>; however, when studying performance in simulations, it can 
save time to set to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>stratify</th>
      <td><p>If <code>TRUE</code>, then a fully stratified estimator is computed, i.e.,
the empirical CDF of each treatment arm is estimated stratifying by levels of 
<code>covar</code>. For now, this option is limited to univariate covariates.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other options (not currently used).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>drord</code>. In addition to information related to 
how <code>drord</code> was called, the output contains the following:</p><dl>
  <dt>log_odds</dt><dd><p>inference pertaining to the log-odds parameter. <code>NULL</code> if 
					 this parameter not requested in call to <code>drord</code>.</p></dd>
  <dt>mann_whitney</dt><dd><p>inference pertaining to the Mann-Whitney parameter. <code>NULL</code> if 
					 this parameter not requested in call to <code>drord</code>.</p></dd>
  <dt>weighted_mean</dt><dd><p>inference pertaining to weighted mean parameter. <code>NULL</code> if 
					 this parameter not requested in call to <code>drord</code>.</p></dd>
  <dt>cdf</dt><dd><p>inference pertaining to the treatment-specific CDFs. See the <code>plot</code>
				method for a convenient way of visualizing this information. <code>NULL</code> 
				if <code>est_dist = FALSE</code> in call to <code>drord</code>.</p></dd>
	 <dt>pmf</dt><dd><p>inference pertaining to the treatment-specific PMFs. See the <code>plot</code>
				method for a convenient way of visualizing this information. <code>NULL</code> 
				if <code>est_dist = FALSE</code> in call to <code>drord</code>.</p></dd>
  <dt>treat_mod</dt><dd><p>the fitted model for the probability of treatment as a function
					  of covariates. <code>NULL</code> if <code>return_models = FALSE</code></p></dd>
  <dt>out_mod</dt><dd><p>the proportional odds model fit in each treatment arm. named entries 
					in list indicate the corresponding treatment arm. 
					<code>NULL</code> if <code>return_models = FALSE</code> or <code>stratify = TRUE</code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In each case, estimates are constructed by obtaining a doubly robust 
estimate of the cumulative distribution function (CDF) for each treatment group. 
This is achieved by fitting a (working) proportional odds model that includes
inverse probability of treatment weights. The inclusion of these weights 
ensures that, so long as the working model includes intercept terms,
the resultant estimate of the CDF is an augmented inverse 
probability of treatment weighted estimate. This implies that the estimate is
nonparametric efficient if the working model contains the truth; however, 
even if the working model does not contain the truth, the CDF estimates are 
consistent and asymptotically normal with variance expected to dominate that
of an unadjusted estimate of the same treatment effect.</p>
<p>The CDF estimates are subsequently mapped into estimates of each requested 
parameter for evaluating treatment effects. The double robustness and efficiency 
properties of the CDF estimates extend to these quantities as well. Confidence
intervals and hypothesis tests can be carried out in closed form using Wald-style
intervals and tests or using a nonparametric corrected and accelerated bootstrap 
(BCa). Inference for the CDF and probability mass function is also returned and 
can be used for subsequent visualizations (see <code>plot.drord</code>).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>covid19</span><span class='op'>)</span>

<span class='co'># get estimates of all parameters based on main-effects </span>
<span class='co'># proportional odds model and intercept-only propensity model</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>drord</span><span class='op'>(</span>out <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>out</span>, treat <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>treat</span>, 
             covar <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>[</span>, <span class='st'>"age_grp"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'># get estimates of all parameters based on proportional odds and</span>
<span class='co'># propensity model that treats age_grp as categorical</span>
<span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'>drord</span><span class='op'>(</span>out <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>out</span>, treat <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>treat</span>, 
              covar <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>[</span>, <span class='st'>"age_grp"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,
         out_form <span class='op'>=</span> <span class='st'>"factor(age_grp)"</span>,
         treat_form <span class='op'>=</span> <span class='st'>"factor(age_grp)"</span><span class='op'>)</span>

<span class='co'># obtain estimator stratified by age group </span>
<span class='va'>fit3</span> <span class='op'>&lt;-</span> <span class='fu'>drord</span><span class='op'>(</span>out <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>out</span>, treat <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>treat</span>, 
              covar <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>[</span>, <span class='st'>"age_grp"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,
         stratify <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># demonstration with missing outcome data</span>
<span class='va'>covid19</span><span class='op'>$</span><span class='va'>out</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>

<span class='co'># propensity model should now adjust for covariates to address</span>
<span class='co'># the potential for informative missingness</span>
<span class='va'>fit4</span> <span class='op'>&lt;-</span> <span class='fu'>drord</span><span class='op'>(</span>out <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>out</span>, treat <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>$</span><span class='va'>treat</span>, 
              covar <span class='op'>=</span> <span class='va'>covid19</span><span class='op'>[</span>, <span class='st'>"age_grp"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,
         treat_form <span class='op'>=</span> <span class='st'>"age_grp"</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Benkeser.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


